<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>経費一覧</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <h1>経費入力リスト</h1>
  <div id="expenseData">読み込み中...</div>

  <nav>
    <a href="index.html">トップ</a> |
    <a href="input.html">入力フォーム</a> |
    <a href="income-records.html">売上一覧</a>
  </nav>

  <script>
    const SHEET_NAME = '経費入力リスト';
    const API_URL = 'https://script.google.com/macros/s/AKfycbxgTuaGcu-X-Zg3cSDu7jMs913YciM80f9J3hOaZvYgRf4HZfv_4JJN3fi2kBVghAfPQw/exec';

    async function loadExpense() {
      try {
        const res = await fetch(`${API_URL}?sheet=${encodeURIComponent(SHEET_NAME)}`);
        const data = await res.json();

        if (!Array.isArray(data) || data.length === 0) {
          document.getElementById('expenseData').textContent = 'データがありません。';
          return;
        }

        let table = '<table><thead><tr>';
        Object.keys(data[0]).forEach(key => {
          table += `<th>${key}</th>`;
        });
        table += '</tr></thead><tbody>';

        data.forEach(row => {
          table += '<tr>';
          Object.values(row).forEach(cell => {
            table += `<td>${cell}</td>`;
          });
          table += '</tr>';
        });
        table += '</tbody></table>';
        document.getElementById('expenseData').innerHTML = table;

      } catch (err) {
        document.getElementById('expenseData').textContent = '読み込みエラー';
        console.error(err);
      }
    }

    loadExpense();
  </script>
</body>
</html>