<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>データ入力フォーム</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <h1>データ入力</h1>

  <!-- 入力種別の選択 -->
  <label><input type="radio" name="formType" value="expense" checked> 経費入力</label>
  <label><input type="radio" name="formType" value="income"> 売上入力</label>

  <!-- 経費フォーム -->
  <form id="expenseForm">
    <h2>経費入力</h2>
    <label>日付：<input type="date" name="date" required></label>
    <label>メンバー名：
      <select name="member">
        <option>瑠夏</option>
        <option>翔</option>
        <option>魔琥</option>
        <option>晴樹</option>
        <option>翼</option>
      </select>
    </label>
    <label>品目：
      <select name="item">
        <option>チェキフィルム(10枚)</option>
        <option>チェキフィルム(20枚)</option>
        <option>チェキフィルム(5枚)</option>
        <option>Tシャツ</option>
        <option>タオル</option>
        <option>アクスタ</option>
        <option>ビラ</option>
        <option>箱代</option>
        <option>その他(備考に品目記載要)</option>
      </select>
    </label>
    <label>単価：<input type="number" name="price" required></label>
    <label>個数：
      <select name="count" id="expenseCount"></select>
    </label>
    <label>備考：<input type="text" name="note"></label>
    <button type="submit">送信</button>
  </form>

  <!-- 売上フォーム -->
  <form id="incomeForm" style="display: none;">
    <h2>売上入力</h2>
    <label>日付：<input type="date" name="date" required></label>
    <label>品目：
      <select name="item">
        <option>Tシャツ</option>
        <option>タオル</option>
        <option>当日チェキ</option>
        <option>2ショット</option>
        <option>アクスタ</option>
        <option>その他チェキ</option>
        <option>その他(備考に記載要)</option>
      </select>
    </label>
    <label>単価：<input type="number" name="price" required></label>
    <label>個数：
      <select name="count" id="incomeCount"></select>
    </label>
    <label>振り分け先：
      <select name="dest">
        <option>瑠夏</option>
        <option>翔</option>
        <option>魔琥</option>
        <option>晴樹</option>
        <option>翼</option>
        <option>バンド</option>
      </select>
    </label>
    <label>備考：<input type="text" name="note"></label>
    <button type="submit">送信</button>
  </form>

  <!-- ナビゲーション -->
  <nav>
    <a href="index.html">トップ</a> |
    <a href="expense-records.html">経費一覧</a> |
    <a href="income-records.html">売上一覧</a>
  </nav>

  <!-- JavaScript -->
  <script>
  const apiUrl = 'https://script.google.com/macros/s/AKfycbxgTuaGcu-X-Zg3cSDu7jMs913YciM80f9J3hOaZvYgRf4HZfv_4JJN3fi2kBVghAfPQw/exec';

  // 個数のプルダウンを生成
  function populateCountOptions(id) {
    const select = document.getElementById(id);
    if (!select) return;
    for (let i = 1; i <= 100; i++) {
      const option = document.createElement('option');
      option.value = i;
      option.text = i;
      select.appendChild(option);
    }
  }

  window.addEventListener('load', () => {
    populateCountOptions('expenseCount');
    populateCountOptions('incomeCount');
  });

  // フォーム切り替え
  document.querySelectorAll('input[name="formType"]').forEach(r => {
    r.addEventListener('change', () => {
      const isExpense = r.value === 'expense';
      document.getElementById('expenseForm').style.display = isExpense ? 'block' : 'none';
      document.getElementById('incomeForm').style.display = isExpense ? 'none' : 'block';
    });
  });

  // 経費送信
  document.getElementById('expenseForm').addEventListener('submit', async e => {
    e.preventDefault();
    const data = new FormData(e.target);
    const body = {
      type: 'expense',
      date: data.get('date'),
      member: data.get('member'),
      item: data.get('item'),
      price: data.get('price'),
      count: data.get('count'),
      note: data.get('note')
    };
    await fetch(apiUrl, {
      method: 'POST',
      body: JSON.stringify(body)
    });
    alert('経費データを送信しました！');
    e.target.reset();
  });

  // 売上送信
  document.getElementById('incomeForm').addEventListener('submit', async e => {
    e.preventDefault();
    const data = new FormData(e.target);
    const body = {
      type: 'income',
      date: data.get('date'),
      item: data.get('item'),
      price: data.get('price'),
      count: data.get('count'),
      dest: data.get('dest'),
      note: data.get('note')
    };
    await fetch(apiUrl, {
      method: 'POST',
      body: JSON.stringify(body)
    });
    alert('売上データを送信しました！');
    e.target.reset();
  });
</script>
</body>
</html>