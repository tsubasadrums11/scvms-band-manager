<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>バン費・個人費リスト</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>バン費・個人費リスト</h1>
  <div id="sheetData">読み込み中...</div>

  <nav>
    <a href="input.html">入力フォーム</a> |
    <a href="expense-records.html">経費一覧</a> |
    <a href="income-records.html">売上一覧</a>
  </nav>

  <script>
    const SHEET_NAME = 'バン費、個人費リスト';
    const API_URL = 'https://script.google.com/macros/s/AKfycbyuYzWPlstNkHeh8QA5_f9tJuG5Xc6HTT8Oi36p5X5TYDBH5ndQPSeGT2XI5X2caUJmcQ/exec';

    async function loadSheet() {
      try {
        const res = await fetch(`${API_URL}?sheet=${encodeURIComponent(SHEET_NAME)}`);
        const data = await res.json();

        if (!Array.isArray(data) || data.length === 0) {
          document.getElementById('sheetData').textContent = 'データがありません。';
          return;
        }

        let table = '<table><thead><tr>';
        Object.keys(data[0]).forEach(key => {
          table += `<th>${key}</th>`;
        });
        table += '</tr></thead><tbody>';

        data.forEach(row => {
          table += '<tr>';
          Object.values(row).forEach(cell => {
            table += `<td>${cell}</td>`;
          });
          table += '</tr>';
        });
        table += '</tbody></table>';
        document.getElementById('sheetData').innerHTML = table;

      } catch (err) {
        document.getElementById('sheetData').textContent = '読み込みエラー';
        console.error(err);
      }
    }

    loadSheet();
  </script>
</body>
</html>